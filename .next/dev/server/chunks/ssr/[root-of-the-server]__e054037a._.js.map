{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/franc/OneDrive%20-%20Universidad%20Mayor/Escritorio/proyecto%20sergio/control-onco-papa/lib/db.ts"],"sourcesContent":["import Dexie, { Table } from \"dexie\";\r\nimport { Entry, Professional } from \"./types\";\r\n\r\nclass LocalDB extends Dexie {\r\n  entries!: Table<Entry, string>;\r\n  professionals!: Table<Professional, string>;\r\n\r\n  constructor() {\r\n    super(\"controlOncoPapa\");\r\n    this.version(1).stores({\r\n      entries: \"id, type, dateTime, status, professionalId\",\r\n      professionals: \"id, name, specialty\"\r\n    });\r\n  }\r\n}\r\n\r\nexport const localDB = new LocalDB();\r\n"],"names":[],"mappings":";;;;AAAA;;;;;;AAGA,MAAM,gBAAgB,iKAAK;IACzB,QAA+B;IAC/B,cAA4C;IAE5C,aAAc;QACZ,KAAK,CAAC;QACN,IAAI,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC;YACrB,SAAS;YACT,eAAe;QACjB;IACF;AACF;AAEO,MAAM,UAAU,IAAI"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/franc/OneDrive%20-%20Universidad%20Mayor/Escritorio/proyecto%20sergio/control-onco-papa/pages/profesionales.tsx"],"sourcesContent":["import { useEffect, useMemo, useState } from \"react\";\r\nimport { localDB } from \"../lib/db\";\r\nimport type { Professional } from \"../lib/types\";\r\n\r\nfunction nowISO() {\r\n  return new Date().toISOString();\r\n}\r\n\r\nexport default function ProfesionalesPage() {\r\n  const [pros, setPros] = useState<Professional[]>([]);\r\n  const [name, setName] = useState(\"\");\r\n  const [specialty, setSpecialty] = useState(\"\");\r\n  const [center, setCenter] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [notes, setNotes] = useState(\"\");\r\n\r\n  async function refresh() {\r\n    const p = await localDB.professionals.orderBy(\"name\").toArray();\r\n    setPros(p);\r\n  }\r\n\r\n  useEffect(() => {\r\n    refresh();\r\n  }, []);\r\n\r\n  const bySpecialty = useMemo(() => {\r\n    const map = new Map<string, number>();\r\n    for (const p of pros) {\r\n      map.set(p.specialty, (map.get(p.specialty) || 0) + 1);\r\n    }\r\n    return Array.from(map.entries()).sort((a, b) => a[0].localeCompare(b[0]));\r\n  }, [pros]);\r\n\r\n  async function addProfessional() {\r\n    if (!name.trim() || !specialty.trim()) {\r\n      alert(\"Falta Nombre y Especialidad\");\r\n      return;\r\n    }\r\n    const ts = nowISO();\r\n    const prof: Professional = {\r\n      id: crypto.randomUUID(),\r\n      name: name.trim(),\r\n      specialty: specialty.trim(),\r\n      center: center.trim() || undefined,\r\n      phone: phone.trim() || undefined,\r\n      notes: notes.trim() || undefined,\r\n      createdAt: ts,\r\n      updatedAt: ts\r\n    };\r\n    await localDB.professionals.put(prof);\r\n    setName(\"\");\r\n    setSpecialty(\"\");\r\n    setCenter(\"\");\r\n    setPhone(\"\");\r\n    setNotes(\"\");\r\n    await refresh();\r\n  }\r\n\r\n  async function deleteProfessional(id: string) {\r\n    const hasEntries = (await localDB.entries.where(\"professionalId\").equals(id).count()) > 0;\r\n    if (hasEntries) {\r\n      alert(\"Este profesional está asociado a registros. Primero quita/edita esos registros y luego elimina al profesional.\");\r\n      return;\r\n    }\r\n    if (!confirm(\"¿Eliminar este profesional?\")) return;\r\n    await localDB.professionals.delete(id);\r\n    await refresh();\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h1>Profesionales</h1>\r\n\r\n      <div className=\"card\" style={{ marginBottom: 12 }}>\r\n        <b>Agregar profesional</b>\r\n        <div style={{ marginTop: 10, display: \"grid\", gap: 10 }}>\r\n          <div className=\"row\">\r\n            <div style={{ flex: 1 }}>\r\n              <small>Nombre</small>\r\n              <input value={name} onChange={(e) => setName(e.target.value)} placeholder=\"Ej: Dr. Juan Pérez\" />\r\n            </div>\r\n            <div style={{ flex: 1 }}>\r\n              <small>Especialidad</small>\r\n              <input value={specialty} onChange={(e) => setSpecialty(e.target.value)} placeholder=\"Ej: Traumatología\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"row\">\r\n            <div style={{ flex: 1 }}>\r\n              <small>Centro (opcional)</small>\r\n              <input value={center} onChange={(e) => setCenter(e.target.value)} placeholder=\"Ej: Clínica / Hospital\" />\r\n            </div>\r\n            <div style={{ flex: 1 }}>\r\n              <small>Teléfono (opcional)</small>\r\n              <input value={phone} onChange={(e) => setPhone(e.target.value)} placeholder=\"+56 9 ...\" />\r\n            </div>\r\n          </div>\r\n\r\n          <div>\r\n            <small>Notas (opcional)</small>\r\n            <textarea value={notes} onChange={(e) => setNotes(e.target.value)} rows={3} placeholder=\"Ej: Derivado por dolor cadera\" />\r\n          </div>\r\n\r\n          <button className=\"btn\" onClick={addProfessional}>Guardar profesional</button>\r\n          <small>Tip: puedes escribir cualquier especialidad (urología, oncología, traumatología, etc.).</small>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"card\" style={{ marginBottom: 12 }}>\r\n        <b>Resumen por especialidad</b>\r\n        <div style={{ marginTop: 10, display: \"grid\", gap: 6 }}>\r\n          {bySpecialty.length ? bySpecialty.map(([s, n]) => (\r\n            <div key={s}>{s}: <b>{n}</b></div>\r\n          )) : <small>Aún no hay profesionales.</small>}\r\n        </div>\r\n      </div>\r\n\r\n      <div style={{ display: \"grid\", gap: 10 }}>\r\n        {pros.map((p) => (\r\n          <div className=\"card\" key={p.id}>\r\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", gap: 10 }}>\r\n              <div>\r\n                <b>{p.name}</b>\r\n                <div><small>{p.specialty}</small></div>\r\n                {p.center && <div><small>Centro: {p.center}</small></div>}\r\n                {p.phone && <div><small>Tel: {p.phone}</small></div>}\r\n              </div>\r\n              <button className=\"btn2\" onClick={() => deleteProfessional(p.id)}>Eliminar</button>\r\n            </div>\r\n            {p.notes && <div style={{ marginTop: 8 }}>{p.notes}</div>}\r\n          </div>\r\n        ))}\r\n        {!pros.length && <div className=\"card\">Sin profesionales aún.</div>}\r\n      </div>\r\n\r\n      <div style={{ marginTop: 12 }}>\r\n        <a href=\"/\" className=\"btn2\" style={{ display: \"inline-block\", textDecoration: \"none\" }}>← Volver</a>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}